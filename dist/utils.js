"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.listRepositoryReleaseAssets = exports.getRepositoryReleaseByTag = exports.getRepositoryReleaseAsset = exports.getRepositoryRelease = exports.getRepositoryLatestRelease = exports.downloadRepositoryReleaseAsset = exports.createOctokit = exports.getTestingModule = void 0;
const promises_1 = __importDefault(require("node:fs/promises"));
const node_path_1 = __importDefault(require("node:path"));
const core_1 = __importDefault(require("@actions/core"));
const github_1 = __importDefault(require("@actions/github"));
const m = {
    createOctokit() {
        const authToken = core_1.default.getInput('auth-token', { required: true });
        if (!authToken) {
            throw new Error('Failed to create Octokit instance (no authentication token provided)');
        }
        return github_1.default.getOctokit(authToken);
    },
    async getRepositoryLatestRelease(params, octokit) {
        const { data } = await octokit.rest.repos.getLatestRelease({
            ...params
        });
        return data;
    },
    async getRepositoryReleaseByTag(params, octokit) {
        const { data } = await octokit.rest.repos.getReleaseByTag({
            ...params
        });
        return data;
    },
    async getRepositoryRelease(params, octokit) {
        const { data } = await octokit.rest.repos.getRelease({
            ...params
        });
        return data;
    },
    async listRepositoryReleaseAssets(params, octokit) {
        const { data } = await octokit.rest.repos.listReleaseAssets({
            ...params
        });
        return data;
    },
    async getRepositoryReleaseAsset(params, octokit) {
        const { data } = await octokit.rest.repos.getReleaseAsset({
            ...params
        });
        return data;
    },
    async downloadRepositoryReleaseAsset(params, destinationFolder, octokit) {
        await promises_1.default.mkdir(destinationFolder, {
            recursive: true
        });
        const asset = await m.getRepositoryReleaseAsset(params, octokit);
        const destination = node_path_1.default.resolve(destinationFolder.toString('utf-8'), asset.name);
        const { data } = await octokit.rest.repos.getReleaseAsset({
            ...params,
            headers: {
                accept: 'application/octet-stream'
            }
        });
        await promises_1.default.writeFile(destination, Buffer.from(data), 'binary');
        return destination;
    }
};
function getTestingModule() {
    return m;
}
exports.getTestingModule = getTestingModule;
exports.createOctokit = m.createOctokit, exports.downloadRepositoryReleaseAsset = m.downloadRepositoryReleaseAsset, exports.getRepositoryLatestRelease = m.getRepositoryLatestRelease, exports.getRepositoryRelease = m.getRepositoryRelease, exports.getRepositoryReleaseAsset = m.getRepositoryReleaseAsset, exports.getRepositoryReleaseByTag = m.getRepositoryReleaseByTag, exports.listRepositoryReleaseAssets = m.listRepositoryReleaseAssets;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRUEsZ0VBQWtDO0FBQ2xDLDBEQUE2QjtBQUc3Qix5REFBaUM7QUFDakMsNkRBQXFDO0FBNEVyQyxNQUFNLENBQUMsR0FBRztJQU1OLGFBQWE7UUFDVCxNQUFNLFNBQVMsR0FBRyxjQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRSxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO1FBQ2hFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUNiLE1BQU0sSUFBSSxLQUFLLENBQ1gsc0VBQXNFLENBQ3pFLENBQUM7UUFDTixDQUFDO1FBQ0QsT0FBTyxnQkFBTSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBV0QsS0FBSyxDQUFDLDBCQUEwQixDQUM1QixNQUEyQixFQUMzQixPQUFnQjtRQUVoQixNQUFNLEVBQUMsSUFBSSxFQUFDLEdBQUcsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQztZQUNyRCxHQUFHLE1BQU07U0FDWixDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBV0QsS0FBSyxDQUFDLHlCQUF5QixDQUMzQixNQUEwQixFQUMxQixPQUFnQjtRQUVoQixNQUFNLEVBQUMsSUFBSSxFQUFDLEdBQUcsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUM7WUFDcEQsR0FBRyxNQUFNO1NBQ1osQ0FBQyxDQUFDO1FBQ0gsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQVdELEtBQUssQ0FBQyxvQkFBb0IsQ0FDdEIsTUFBcUIsRUFDckIsT0FBZ0I7UUFFaEIsTUFBTSxFQUFDLElBQUksRUFBQyxHQUFHLE1BQU0sT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDO1lBQy9DLEdBQUcsTUFBTTtTQUNaLENBQUMsQ0FBQztRQUNILE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFXRCxLQUFLLENBQUMsMkJBQTJCLENBQzdCLE1BQTJCLEVBQzNCLE9BQWdCO1FBRWhCLE1BQU0sRUFBQyxJQUFJLEVBQUMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDO1lBQ3RELEdBQUcsTUFBTTtTQUNaLENBQUMsQ0FBQztRQUNILE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFXRCxLQUFLLENBQUMseUJBQXlCLENBQzNCLE1BQTBCLEVBQzFCLE9BQWdCO1FBRWhCLE1BQU0sRUFBQyxJQUFJLEVBQUMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQztZQUNwRCxHQUFHLE1BQU07U0FDWixDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBWUQsS0FBSyxDQUFDLDhCQUE4QixDQUNoQyxNQUEwQixFQUMxQixpQkFBMkIsRUFDM0IsT0FBZ0I7UUFHaEIsTUFBTSxrQkFBRSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsRUFBRTtZQUM5QixTQUFTLEVBQUUsSUFBSTtTQUNsQixDQUFDLENBQUM7UUFDSCxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FBQyx5QkFBeUIsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDakUsTUFBTSxXQUFXLEdBQUcsbUJBQUksQ0FBQyxPQUFPLENBQzVCLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsRUFDbkMsS0FBSyxDQUFDLElBQUksQ0FDYixDQUFDO1FBQ0YsTUFBTSxFQUFDLElBQUksRUFBQyxHQUFHLE1BQU0sT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDO1lBQ3BELEdBQUcsTUFBTTtZQUNULE9BQU8sRUFBRTtnQkFDTCxNQUFNLEVBQUUsMEJBQTBCO2FBQ3JDO1NBQ0osQ0FBQyxDQUFDO1FBQ0gsTUFBTSxrQkFBRSxDQUFDLFNBQVMsQ0FDZCxXQUFXLEVBQ1gsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUE4QixDQUFDLEVBQzNDLFFBQVEsQ0FDWCxDQUFDO1FBQ0YsT0FBTyxXQUFXLENBQUM7SUFDdkIsQ0FBQztDQUNKLENBQUM7QUFTRixTQUFnQixnQkFBZ0I7SUFDNUIsT0FBTyxDQUFDLENBQUM7QUFDYixDQUFDO0FBRkQsNENBRUM7QUFJRyxxQkFBYSxHQU9iLENBQUMsZ0JBTkQsc0NBQThCLEdBTTlCLENBQUMsaUNBTEQsa0NBQTBCLEdBSzFCLENBQUMsNkJBSkQsNEJBQW9CLEdBSXBCLENBQUMsdUJBSEQsaUNBQXlCLEdBR3pCLENBQUMsNEJBRkQsaUNBQXlCLEdBRXpCLENBQUMsNEJBREQsbUNBQTJCLEdBQzNCLENBQUMsNkJBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy0tIE5vZGVKU1xuaW1wb3J0IHtQYXRoTGlrZX0gZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQgZnMgZnJvbSAnbm9kZTpmcy9wcm9taXNlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdub2RlOnBhdGgnO1xuXG4vLy0tIE5QTSBQYWNrYWdlc1xuaW1wb3J0IGNvcmUgZnJvbSAnQGFjdGlvbnMvY29yZSc7XG5pbXBvcnQgZ2l0aHViIGZyb20gJ0BhY3Rpb25zL2dpdGh1Yic7XG5pbXBvcnQge0VuZHBvaW50c30gZnJvbSAnQG9jdG9raXQvdHlwZXMnO1xuXG4vKipcbiAqIEFuIGFsaWFzIHR5cGUgZm9yIEdpdEh1YiBPY3Rva2l0IG9iamVjdHMuXG4gKi9cbmV4cG9ydCB0eXBlIE9jdG9raXQgPSBSZXR1cm5UeXBlPCh0eXBlb2YgZ2l0aHViKVsnZ2V0T2N0b2tpdCddPjtcblxuLyoqXG4gKiBBbiBhbGlhcyB0eXBlIGZvciB0aGUgcmVsZWFzZSBvYmplY3QgcmV0dXJuZWQgZnJvbSBhIHtAbGluayBPY3Rva2l0fVxuICogaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCB0eXBlIFJlbGVhc2UgPVxuICAgIEVuZHBvaW50c1snR0VUIC9yZXBvcy97b3duZXJ9L3tyZXBvfS9yZWxlYXNlcy97cmVsZWFzZV9pZH0nXVsncmVzcG9uc2UnXVsnZGF0YSddO1xuXG4vKipcbiAqIEFuIGFsaWFzIHR5cGUgZm9yIHRoZSBpbnB1dHMgcmVxdWlyZWQgdG8gZ2V0IGEge0BsaW5rIFJlbGVhc2V9IG9iamVjdC5cbiAqL1xuZXhwb3J0IHR5cGUgUmVsZWFzZUlucHV0cyA9XG4gICAgRW5kcG9pbnRzWydHRVQgL3JlcG9zL3tvd25lcn0ve3JlcG99L3JlbGVhc2VzL3tyZWxlYXNlX2lkfSddWydwYXJhbWV0ZXJzJ107XG5cbi8qKlxuICogQW4gYWxpYXMgdHlwZSBmb3IgdGhlIHJlbGVhc2Ugb2JqZWN0IHJldHVybmVkIGZyb20gYSB7QGxpbmsgT2N0b2tpdH1cbiAqIGluc3RhbmNlLlxuICovXG5leHBvcnQgdHlwZSBSZWxlYXNlQnlUYWcgPVxuICAgIEVuZHBvaW50c1snR0VUIC9yZXBvcy97b3duZXJ9L3tyZXBvfS9yZWxlYXNlcy90YWdzL3t0YWd9J11bJ3Jlc3BvbnNlJ11bJ2RhdGEnXTtcblxuLyoqXG4gKiBBbiBhbGlhcyB0eXBlIGZvciB0aGUgaW5wdXRzIHJlcXVpcmVkIHRvIGdldCBhIHtAbGluayBSZWxlYXNlfSBvYmplY3QuXG4gKi9cbmV4cG9ydCB0eXBlIFJlbGVhc2VCeVRhZ0lucHV0cyA9XG4gICAgRW5kcG9pbnRzWydHRVQgL3JlcG9zL3tvd25lcn0ve3JlcG99L3JlbGVhc2VzL3RhZ3Mve3RhZ30nXVsncGFyYW1ldGVycyddO1xuXG4vKipcbiAqIEFuIGFsaWFzIHR5cGUgZm9yIHRoZSByZWxlYXNlIG9iamVjdCByZXR1cm5lZCBmcm9tIGEge0BsaW5rIE9jdG9raXR9XG4gKiBpbnN0YW5jZS5cbiAqL1xuZXhwb3J0IHR5cGUgTGF0ZXN0UmVsZWFzZSA9XG4gICAgRW5kcG9pbnRzWydHRVQgL3JlcG9zL3tvd25lcn0ve3JlcG99L3JlbGVhc2VzL2xhdGVzdCddWydyZXNwb25zZSddWydkYXRhJ107XG5cbi8qKlxuICogQW4gYWxpYXMgdHlwZSBmb3IgdGhlIGlucHV0cyByZXF1aXJlZCB0byBnZXQgYSB7QGxpbmsgTGF0ZXN0UmVsZWFzZX0gb2JqZWN0LlxuICovXG5leHBvcnQgdHlwZSBMYXRlc3RSZWxlYXNlSW5wdXRzID1cbiAgICBFbmRwb2ludHNbJ0dFVCAvcmVwb3Mve293bmVyfS97cmVwb30vcmVsZWFzZXMvbGF0ZXN0J11bJ3BhcmFtZXRlcnMnXTtcblxuLyoqXG4gKiBBbiBhbGlhcyB0eXBlIGZvciB0aGUgcmVsZWFzZSBhc3NldCBsaXN0IHJldHVybmVkIGZyb20gYSB7QGxpbmsgT2N0b2tpdH1cbiAqIGluc3RhbmNlLlxuICovXG5leHBvcnQgdHlwZSBSZWxlYXNlQXNzZXRzID1cbiAgICBFbmRwb2ludHNbJ0dFVCAvcmVwb3Mve293bmVyfS97cmVwb30vcmVsZWFzZXMve3JlbGVhc2VfaWR9L2Fzc2V0cyddWydyZXNwb25zZSddWydkYXRhJ107XG5cbi8qKlxuICogQW4gYWxpYXMgdHlwZSBmb3IgdGhlIGlucHV0cyByZXF1aXJlZCB0byBnZXQgYSB7QGxpbmsgUmVsZWFzZUFzc2V0c30gbGlzdC5cbiAqL1xuZXhwb3J0IHR5cGUgUmVsZWFzZUFzc2V0c0lucHV0cyA9XG4gICAgRW5kcG9pbnRzWydHRVQgL3JlcG9zL3tvd25lcn0ve3JlcG99L3JlbGVhc2VzL3tyZWxlYXNlX2lkfS9hc3NldHMnXVsncGFyYW1ldGVycyddO1xuXG4vKipcbiAqIEFuIGFsaWFzIHR5cGUgZm9yIHRoZSByZWxlYXNlIGFzc2V0IG9iamVjdCByZXR1cm5lZCBmcm9tIGEge0BsaW5rIE9jdG9raXR9XG4gKiBpbnN0YW5jZS5cbiAqL1xuZXhwb3J0IHR5cGUgUmVsZWFzZUFzc2V0ID1cbiAgICBFbmRwb2ludHNbJ0dFVCAvcmVwb3Mve293bmVyfS97cmVwb30vcmVsZWFzZXMvYXNzZXRzL3thc3NldF9pZH0nXVsncmVzcG9uc2UnXVsnZGF0YSddO1xuXG4vKipcbiAqIEFuIGFsaWFzIHR5cGUgZm9yIHRoZSBpbnB1dHMgcmVxdWlyZWQgdG8gZ2V0IGEge0BsaW5rIFJlbGVhc2VBc3NldH0gb2JqZWN0LlxuICovXG5leHBvcnQgdHlwZSBSZWxlYXNlQXNzZXRJbnB1dHMgPVxuICAgIEVuZHBvaW50c1snR0VUIC9yZXBvcy97b3duZXJ9L3tyZXBvfS9yZWxlYXNlcy9hc3NldHMve2Fzc2V0X2lkfSddWydwYXJhbWV0ZXJzJ107XG5cbi8qKlxuICogQSBtb2R1bGUgd2hpY2ggcHJvdmlkZXMgYSB1dGlsaXR5IGZ1bmN0aW9uYWxpdHkuXG4gKi9cbmNvbnN0IG0gPSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IHtAbGluayBPY3Rva2l0fSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgbmV3IHtAbGluayBPY3Rva2l0fSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBjcmVhdGVPY3Rva2l0KCk6IE9jdG9raXQge1xuICAgICAgICBjb25zdCBhdXRoVG9rZW4gPSBjb3JlLmdldElucHV0KCdhdXRoLXRva2VuJywge3JlcXVpcmVkOiB0cnVlfSk7XG4gICAgICAgIGlmICghYXV0aFRva2VuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgJ0ZhaWxlZCB0byBjcmVhdGUgT2N0b2tpdCBpbnN0YW5jZSAobm8gYXV0aGVudGljYXRpb24gdG9rZW4gcHJvdmlkZWQpJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZ2l0aHViLmdldE9jdG9raXQoYXV0aFRva2VuKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBsYXRlc3QgcmVsZWFzZSBmb3IgYSBnaXZlbiByZXBvc2l0b3J5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIFRoZSBwYXJhbWV0ZXJzIGRlZmluaW5nIHRoZSByZXBvc2l0b3J5IHRvIGZldGNoXG4gICAgICogaW5mb3JtYXRpb24gZnJvbS5cbiAgICAgKiBAcGFyYW0gb2N0b2tpdCAtIFRoZSB7QGxpbmsgT2N0b2tpdH0gaW5zdGFuY2UgdG8gdXNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIGxhdGVzdCByZWxlYXNlIGZvciB0aGUgZ2l2ZW4gcmVwb3NpdG9yeS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRSZXBvc2l0b3J5TGF0ZXN0UmVsZWFzZShcbiAgICAgICAgcGFyYW1zOiBMYXRlc3RSZWxlYXNlSW5wdXRzLFxuICAgICAgICBvY3Rva2l0OiBPY3Rva2l0XG4gICAgKTogUHJvbWlzZTxMYXRlc3RSZWxlYXNlPiB7XG4gICAgICAgIGNvbnN0IHtkYXRhfSA9IGF3YWl0IG9jdG9raXQucmVzdC5yZXBvcy5nZXRMYXRlc3RSZWxlYXNlKHtcbiAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbGF0ZXN0IHJlbGVhc2UgZm9yIGEgZ2l2ZW4gcmVwb3NpdG9yeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXMgLSBUaGUgcGFyYW1ldGVycyBkZWZpbmluZyB0aGUgcmVwb3NpdG9yeSB0byBmZXRjaFxuICAgICAqIGluZm9ybWF0aW9uIGZyb20uXG4gICAgICogQHBhcmFtIG9jdG9raXQgLSBUaGUge0BsaW5rIE9jdG9raXR9IGluc3RhbmNlIHRvIHVzZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBsYXRlc3QgcmVsZWFzZSBmb3IgdGhlIGdpdmVuIHJlcG9zaXRvcnkuXG4gICAgICovXG4gICAgYXN5bmMgZ2V0UmVwb3NpdG9yeVJlbGVhc2VCeVRhZyhcbiAgICAgICAgcGFyYW1zOiBSZWxlYXNlQnlUYWdJbnB1dHMsXG4gICAgICAgIG9jdG9raXQ6IE9jdG9raXRcbiAgICApOiBQcm9taXNlPFJlbGVhc2VCeVRhZz4ge1xuICAgICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBvY3Rva2l0LnJlc3QucmVwb3MuZ2V0UmVsZWFzZUJ5VGFnKHtcbiAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYSByZWxlYXNlIGZyb20gYSBnaXZlbiByZXBvc2l0b3J5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIFRoZSBwYXJhbWV0ZXJzIGRlZmluaW5nIHRoZSByZXBvc2l0b3J5IHRvIGZldGNoXG4gICAgICogaW5mb3JtYXRpb24gZnJvbS5cbiAgICAgKiBAcGFyYW0gb2N0b2tpdCAtIFRoZSB7QGxpbmsgT2N0b2tpdH0gaW5zdGFuY2UgdG8gdXNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIHJlcXVlc3RlZCByZWxlYXNlIGZvciB0aGUgZ2l2ZW4gcmVwb3NpdG9yeS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRSZXBvc2l0b3J5UmVsZWFzZShcbiAgICAgICAgcGFyYW1zOiBSZWxlYXNlSW5wdXRzLFxuICAgICAgICBvY3Rva2l0OiBPY3Rva2l0XG4gICAgKTogUHJvbWlzZTxSZWxlYXNlPiB7XG4gICAgICAgIGNvbnN0IHtkYXRhfSA9IGF3YWl0IG9jdG9raXQucmVzdC5yZXBvcy5nZXRSZWxlYXNlKHtcbiAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYSByZWxlYXNlIGZyb20gYSBnaXZlbiByZXBvc2l0b3J5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIFRoZSBwYXJhbWV0ZXJzIGRlZmluaW5nIHRoZSByZXBvc2l0b3J5IHRvIGZldGNoXG4gICAgICogaW5mb3JtYXRpb24gZnJvbS5cbiAgICAgKiBAcGFyYW0gb2N0b2tpdCAtIFRoZSB7QGxpbmsgT2N0b2tpdH0gaW5zdGFuY2UgdG8gdXNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIHJlcXVlc3RlZCByZWxlYXNlIGZvciB0aGUgZ2l2ZW4gcmVwb3NpdG9yeS5cbiAgICAgKi9cbiAgICBhc3luYyBsaXN0UmVwb3NpdG9yeVJlbGVhc2VBc3NldHMoXG4gICAgICAgIHBhcmFtczogUmVsZWFzZUFzc2V0c0lucHV0cyxcbiAgICAgICAgb2N0b2tpdDogT2N0b2tpdFxuICAgICk6IFByb21pc2U8UmVsZWFzZUFzc2V0cz4ge1xuICAgICAgICBjb25zdCB7ZGF0YX0gPSBhd2FpdCBvY3Rva2l0LnJlc3QucmVwb3MubGlzdFJlbGVhc2VBc3NldHMoe1xuICAgICAgICAgICAgLi4ucGFyYW1zXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhIHJlbGVhc2UgYXNzZXQgZnJvbSBhIGdpdmVuIHJlcG9zaXRvcnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zIC0gVGhlIHBhcmFtZXRlcnMgZGVmaW5pbmcgdGhlIHJlcG9zaXRvcnkgdG8gZmV0Y2hcbiAgICAgKiBpbmZvcm1hdGlvbiBmcm9tLlxuICAgICAqIEBwYXJhbSBvY3Rva2l0IC0gVGhlIHtAbGluayBPY3Rva2l0fSBpbnN0YW5jZSB0byB1c2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVxdWVzdGVkIHJlbGVhc2UgZm9yIHRoZSBnaXZlbiByZXBvc2l0b3J5LlxuICAgICAqL1xuICAgIGFzeW5jIGdldFJlcG9zaXRvcnlSZWxlYXNlQXNzZXQoXG4gICAgICAgIHBhcmFtczogUmVsZWFzZUFzc2V0SW5wdXRzLFxuICAgICAgICBvY3Rva2l0OiBPY3Rva2l0XG4gICAgKTogUHJvbWlzZTxSZWxlYXNlQXNzZXQ+IHtcbiAgICAgICAgY29uc3Qge2RhdGF9ID0gYXdhaXQgb2N0b2tpdC5yZXN0LnJlcG9zLmdldFJlbGVhc2VBc3NldCh7XG4gICAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEb3dubG9hZCBhIHJlbGVhc2UgYXNzZXQgZnJvbSB0aGUgZ2l2ZW4gcmVwb3NpdG9yeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXMgLSBUaGUgcGFyYW1ldGVycyBkZWZpbmluZyB0aGUgcmVwb3NpdG9yeSB0byBmZXRjaFxuICAgICAqIGluZm9ybWF0aW9uIGZyb20uXG4gICAgICogQHBhcmFtIGRlc3RpbmF0aW9uRm9sZGVyIC0gVGhlIGZvbGRlciB0byBkb3dubG9hZCB0aGUgcmVsZWFzZSBhc3NldCB0by5cbiAgICAgKiBAcGFyYW0gb2N0b2tpdCAtIFRoZSB7QGxpbmsgT2N0b2tpdH0gaW5zdGFuY2UgdG8gdXNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIHBhdGggdG8gdGhlIGRvd25sb2FkZWQgYXNzZXQuXG4gICAgICovXG4gICAgYXN5bmMgZG93bmxvYWRSZXBvc2l0b3J5UmVsZWFzZUFzc2V0KFxuICAgICAgICBwYXJhbXM6IFJlbGVhc2VBc3NldElucHV0cyxcbiAgICAgICAgZGVzdGluYXRpb25Gb2xkZXI6IFBhdGhMaWtlLFxuICAgICAgICBvY3Rva2l0OiBPY3Rva2l0XG4gICAgKTogUHJvbWlzZTxQYXRoTGlrZT4ge1xuICAgICAgICAvLy0tIEVuc3VyZSBvdXQgZGVzdGluYXRpb24gZXhpc3RzXG4gICAgICAgIGF3YWl0IGZzLm1rZGlyKGRlc3RpbmF0aW9uRm9sZGVyLCB7XG4gICAgICAgICAgICByZWN1cnNpdmU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gYXdhaXQgbS5nZXRSZXBvc2l0b3J5UmVsZWFzZUFzc2V0KHBhcmFtcywgb2N0b2tpdCk7XG4gICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgICAgZGVzdGluYXRpb25Gb2xkZXIudG9TdHJpbmcoJ3V0Zi04JyksXG4gICAgICAgICAgICBhc3NldC5uYW1lXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHtkYXRhfSA9IGF3YWl0IG9jdG9raXQucmVzdC5yZXBvcy5nZXRSZWxlYXNlQXNzZXQoe1xuICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IGZzLndyaXRlRmlsZShcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgQnVmZmVyLmZyb20oZGF0YSBhcyB1bmtub3duIGFzIEFycmF5QnVmZmVyKSxcbiAgICAgICAgICAgICdiaW5hcnknXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBkZXN0aW5hdGlvbjtcbiAgICB9XG59O1xuXG4vKipcbiAqIEdldCB0aGUgaW50ZXJuYWwgbW9kdWxlIGZvciB1c2Ugd2l0aCB1bml0IHRlc3RpbmcuXG4gKlxuICogQHJldHVybnMgVGhlIGludGVybmFsIG1vZHVsZS5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRlc3RpbmdNb2R1bGUoKTogdHlwZW9mIG0ge1xuICAgIHJldHVybiBtO1xufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eS1wYXR0ZXJuLCBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2QgKi9cbmV4cG9ydCBjb25zdCB7XG4gICAgY3JlYXRlT2N0b2tpdCxcbiAgICBkb3dubG9hZFJlcG9zaXRvcnlSZWxlYXNlQXNzZXQsXG4gICAgZ2V0UmVwb3NpdG9yeUxhdGVzdFJlbGVhc2UsXG4gICAgZ2V0UmVwb3NpdG9yeVJlbGVhc2UsXG4gICAgZ2V0UmVwb3NpdG9yeVJlbGVhc2VBc3NldCxcbiAgICBnZXRSZXBvc2l0b3J5UmVsZWFzZUJ5VGFnLFxuICAgIGxpc3RSZXBvc2l0b3J5UmVsZWFzZUFzc2V0c1xufSA9IG07XG4vKiBlc2xpbnQtZW5hYmxlIG5vLWVtcHR5LXBhdHRlcm4sIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZCAqL1xuIl19